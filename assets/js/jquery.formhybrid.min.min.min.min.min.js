(function(b){FormhybridPlugins={init:function(c){this.scrollToMessages(c)},scrollToMessages:function(e){if(e=="toggleSubpalette"){return false}var c=b(".formhybrid:first").parent(['class^="mod_"']).find(":input.alert:first, :input.error:first, .alert-success:first, .alter-danger:first, p.alert:first, fieldset.error:first");if(c.length>0){var d=c.offset();b("html,body").animate({scrollTop:parseInt(d.top)},500)}}};FormhybridAjaxRequest={registerEvents:function(){this.asyncSubmit()},asyncSubmit:function(){b(".formhybrid").on("submit","form[data-async]",function(c){var d=b(this),f=d.serializeArray();c.preventDefault();f.push({name:"action",value:"asyncFormSubmit"},{name:"load",value:true});b.ajax({url:d.attr("action"),data:f,method:b(this).attr("method"),success:function(h){var e,h="<div>"+h+"</div>";if(d.data("replace")){e=b(h).find(d.data("replace"));if(e!==undefined){b(d.data("replace")).html(e)}}else{e=b(h).find("#"+d.attr("id"));if(e.length<1){d.html(h);e=h}else{d.replaceWith(e)}}var i=e.find(".alert:first, .error:first");if(i.length>0){var g=i.offset();b("html,body").animate({scrollTop:parseInt(g.top)-70+"px"},500)}}})})},toggleSubpalette:function(e,g,d){e.blur();var c=b(e),h=b("#"+g),f=b(e).closest("form");if(h.length>0){b.ajax({type:"post",url:location.href,data:{action:"toggleSubpalette",id:g,field:d,state:0,REQUEST_TOKEN:Formhybrid.request_token},success:function(){h.remove()}});return}b.ajax({type:"post",url:location.href,dataType:"html",data:{action:"toggleSubpalette",id:g,field:d,load:1,state:1,REQUEST_TOKEN:Formhybrid.request_token},success:function(j,k,i){c.closest("."+d).after(j)}})}};var a={getParameterByName:function(g,h){var e=decodeURIComponent(h),d=e.split("&"),f,c;for(c=0;c<d.length;c++){f=d[c].split("=");if(f[0]===g){return f[1]===undefined?true:f[1]}}}};b(document).ready(function(){FormhybridAjaxRequest.registerEvents();FormhybridPlugins.init()});b(document).ajaxComplete(function(c,e,d){FormhybridPlugins.init(a.getParameterByName("action",d.data))})})(jQuery);