(function(c){FormhybridPlugins={init:function(a){this.scrollToMessages(a)},scrollToMessages:function(a){if(a=="toggleSubpalette"){return false}var f=c(".formhybrid:first").parent(['class^="mod_"']).find(":input.alert:first, :input.error:first, .alert-success:first, .alter-danger:first, p.alert:first, fieldset.error:first");if(f.length>0){var b=f.offset();c("html,body").animate({scrollTop:parseInt(b.top)},500)}}};FormhybridAjaxRequest={registerEvents:function(){this.asyncSubmit()},asyncSubmit:function(){c(".formhybrid").on("submit","form[data-async]",function(e){var b=c(this),a=b.serializeArray();e.preventDefault();a.push({name:"action",value:"asyncFormSubmit"},{name:"load",value:true});c.ajax({url:b.attr("action"),data:a,method:c(this).attr("method"),success:function(j){var l,j="<div>"+j+"</div>";if(b.data("replace")){l=c(j).find(b.data("replace"));if(l!==undefined){c(b.data("replace")).html(l)}}else{l=c(j).find("#"+b.attr("id"));if(l.length<1){b.html(j);l=j}else{b.replaceWith(l)}}var f=l.find(".alert:first, .error:first");if(f.length>0){var k=f.offset();c("html,body").animate({scrollTop:parseInt(k.top)-70+"px"},500)}}})})},toggleSubpalette:function(j,b,k){j.blur();var l=c(j),a=c("#"+b),i=c(j).closest("form");if(a.length>0){c.ajax({type:"post",url:location.href,data:{action:"toggleSubpalette",id:b,field:k,state:0,REQUEST_TOKEN:Formhybrid.request_token},success:function(){a.remove()}});return}c.ajax({type:"post",url:location.href,dataType:"html",data:{action:"toggleSubpalette",id:b,field:k,load:1,state:1,REQUEST_TOKEN:Formhybrid.request_token},success:function(f,e,g){l.closest("."+k).after(f)}})}};var d={getParameterByName:function(b,a){var j=decodeURIComponent(a),k=j.split("&"),i,l;for(l=0;l<k.length;l++){i=k[l].split("=");if(i[0]===b){return i[1]===undefined?true:i[1]}}}};c(document).ready(function(){FormhybridAjaxRequest.registerEvents();FormhybridPlugins.init()});c(document).ajaxComplete(function(f,a,b){FormhybridPlugins.init(d.getParameterByName("action",b.data))})})(jQuery);