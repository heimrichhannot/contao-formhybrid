(function(c){FormhybridPlugins={init:function(a){this.scrollToMessages(a)},scrollToMessages:function(f){if(f=="toggleSubpalette"){return false}var b=c(".formhybrid:first").parent(['class^="mod_"']).find(":input.alert:first, :input.error:first, .alert-success:first, .alter-danger:first, p.alert:first, fieldset.error:first");if(b.length>0){var a=b.offset();c("html,body").animate({scrollTop:parseInt(a.top)},500)}}};FormhybridAjaxRequest={registerEvents:function(){this.asyncSubmit()},asyncSubmit:function(){c(".formhybrid").on("submit","form[data-async]",function(b){var a=c(this),e=a.serializeArray();b.preventDefault();e.push({name:"action",value:"asyncFormSubmit"},{name:"load",value:true});c.ajax({url:a.attr("action"),data:e,method:c(this).attr("method"),success:function(j){var l,j="<div>"+j+"</div>";if(a.data("replace")){l=c(j).find(a.data("replace"));if(l!==undefined){c(a.data("replace")).html(l)}}else{l=c(j).find("#"+a.attr("id"));if(l.length<1){a.html(j);l=j}else{a.replaceWith(l)}}var f=l.find(".alert:first, .error:first");if(f.length>0){var k=f.offset();c("html,body").animate({scrollTop:parseInt(k.top)-70+"px"},500)}}})})},toggleSubpalette:function(a,j,l){a.blur();var b=c(a),i=c("#"+j),k=c(a).closest("form");if(i.length>0){c.ajax({type:"post",url:location.href,data:{action:"toggleSubpalette",id:j,field:l,state:0,REQUEST_TOKEN:Formhybrid.request_token},success:function(){i.remove()}});return}c.ajax({type:"post",url:location.href,dataType:"html",data:{action:"toggleSubpalette",id:j,field:l,load:1,state:1,REQUEST_TOKEN:Formhybrid.request_token},success:function(f,e,g){b.closest("."+l).after(f)}})}};var d={getParameterByName:function(j,i){var l=decodeURIComponent(i),a=l.split("&"),k,b;for(b=0;b<a.length;b++){k=a[b].split("=");if(k[0]===j){return k[1]===undefined?true:k[1]}}}};c(document).ready(function(){FormhybridAjaxRequest.registerEvents();FormhybridPlugins.init()});c(document).ajaxComplete(function(b,f,a){FormhybridPlugins.init(d.getParameterByName("action",a.data))})})(jQuery);