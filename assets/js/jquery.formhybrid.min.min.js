(function(c){FormhybridPlugins={init:function(a){this.scrollToMessages(a)},scrollToMessages:function(b){if(b=="toggleSubpalette"){return false}var a=c(".formhybrid:first").parent(['class^="mod_"']).find(":input.alert:first, :input.error:first, .alert-success:first, .alter-danger:first, p.alert:first, fieldset.error:first");if(a.length>0){var f=a.offset();c("html,body").animate({scrollTop:parseInt(f.top)},500)}}};FormhybridAjaxRequest={registerEvents:function(){this.asyncSubmit()},asyncSubmit:function(){c(".formhybrid").on("submit","form[data-async]",function(a){var e=c(this),b=e.serializeArray();a.preventDefault();b.push({name:"action",value:"asyncFormSubmit"},{name:"load",value:true});c.ajax({url:e.attr("action"),data:b,method:c(this).attr("method"),success:function(j){var l,j="<div>"+j+"</div>";if(e.data("replace")){l=c(j).find(e.data("replace"));if(l!==undefined){c(e.data("replace")).html(l)}}else{l=c(j).find("#"+e.attr("id"));if(l.length<1){e.html(j);l=j}else{e.replaceWith(l)}}var f=l.find(".alert:first, .error:first");if(f.length>0){var k=f.offset();c("html,body").animate({scrollTop:parseInt(k.top)-70+"px"},500)}}})})},toggleSubpalette:function(i,a,b){i.blur();var j=c(i),k=c("#"+a),l=c(i).closest("form");if(k.length>0){c.ajax({type:"post",url:location.href,data:{action:"toggleSubpalette",id:a,field:b,state:0,REQUEST_TOKEN:Formhybrid.request_token},success:function(){k.remove()}});return}c.ajax({type:"post",url:location.href,dataType:"html",data:{action:"toggleSubpalette",id:a,field:b,load:1,state:1,REQUEST_TOKEN:Formhybrid.request_token},success:function(f,e,g){j.closest("."+b).after(f)}})}};var d={getParameterByName:function(l,k){var b=decodeURIComponent(k),i=b.split("&"),a,j;for(j=0;j<i.length;j++){a=i[j].split("=");if(a[0]===l){return a[1]===undefined?true:a[1]}}}};c(document).ready(function(){FormhybridAjaxRequest.registerEvents();FormhybridPlugins.init()});c(document).ajaxComplete(function(a,b,f){FormhybridPlugins.init(d.getParameterByName("action",f.data))})})(jQuery);