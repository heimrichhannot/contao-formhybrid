(function(b){FormhybridPlugins={init:function(c){},scrollToMessages:function(d){if(d=="toggleSubpalette"){return false}var e=b(".formhybrid:first").not(".noscroll").parent(['class^="mod_"']).find(":input.alert:first, :input.error:first, .alert-success:first, .alter-danger:first, p.alert:first, fieldset.error:first");if(e.length>0){var c=e.offset();b("html,body").animate({scrollTop:parseInt(c.top)},500)}}};FormhybridAjaxRequest={registerEvents:function(){this.asyncSubmit()},asyncSubmit:function(d){if(typeof d!=="undefined"){var c=b(d);if(c.length>0){FormhybridAjaxRequest._asyncFormSubmit(c)}return false}b("body").on("submit",".formhybrid form[data-async]",function(g){var f=b(this);g.preventDefault();FormhybridAjaxRequest._asyncFormSubmit(f)})},_asyncFormSubmit:function(c,d){$formData=c.serializeArray();$formData.push({name:"action",value:"asyncFormSubmit"},{name:"load",value:true},{name:"FORM_SUBMIT",value:c.attr("id")});if(typeof d!="undefined"){$formData.push(d)}b.ajax({url:c.attr("action"),data:$formData,method:c.attr("method"),success:function(h){var f;try{dataJson=b.parseJSON(h);if(dataJson.type=="redirect"){location.href=dataJson.url;return}}catch(i){}h="<div>"+h+"</div>";if(c.data("replace")){f=b(h).find(c.data("replace"));if(f!==undefined){b(c.data("replace")).html(f)}}else{f=b(h).find("#"+c.attr("id"));if(f.length<1){c.html(h);f=h}else{c.replaceWith(f)}}var j=f.find(".alert:first, .error:first");if(j.length>0&&!b(".formhybrid:first").hasClass("noscroll")){var g=j.offset();b("html,body").animate({scrollTop:parseInt(g.top)-70+"px"},500)}if(b(h).find("form").data("close-modal-on-submit")&&c.data("has-errors")!=1){f.closest(".modal").find(".close").trigger("click")}}})},toggleSubpalette:function(f,j,i){f.blur();var e=b(f),d=b("#"+j),c=e.closest("form"),g=true,h={action:"toggleSubpalette",id:j,field:i,REQUEST_TOKEN:Formhybrid.request_token,FORM_SUBMIT:c.attr("id")};if(e.is(":checkbox")||e.is(":radio")){g=e.is(":checked")}if(g===false){h[i]=0;b.ajax({type:"post",url:location.href,data:h,success:function(){d.remove()}});return}h[i]=e.val();h.load=1;b.ajax({type:"post",url:location.href,dataType:"html",data:h,success:function(l,m,k){d.remove();if(e.closest("form").find("."+i).length>0){e.closest("form").find("."+i).eq(0).after(l)}else{e.closest("#ctrl_"+i).after(l)}}})},reload:function(d){var c=b("#"+d);this._asyncFormSubmit(c,{name:"skipValidation",value:true})},};var a={getParameterByName:function(c,d){var g=decodeURIComponent(d),f=g.split("&"),h,e;for(e=0;e<f.length;e++){h=f[e].split("=");if(h[0]===c){return h[1]===undefined?true:h[1]}}}};b(document).ready(function(){FormhybridAjaxRequest.registerEvents();FormhybridPlugins.init()});b(document).ajaxComplete(function(e,d,c){FormhybridPlugins.init(a.getParameterByName("action",c.data))})})(jQuery);