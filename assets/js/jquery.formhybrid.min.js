(function(b){FormhybridPlugins={init:function(c){this.scrollToMessages()},scrollToMessages:function(d){if(typeof d==="undefined"){d=b(".formhybrid:first")}var c=d.find(".alert:first, .error:first");if(c.length>0&&!d.hasClass("noscroll")){HASTE_PLUS.scrollTo(c,100,500)}}};FormhybridAjaxRequest={registerEvents:function(){this.asyncSubmit()},asyncSubmit:function(d){if(typeof d!=="undefined"){var c=b(d);if(c.length>0){FormhybridAjaxRequest._asyncFormSubmit(c)}return false}b(document).on("submit",".formhybrid form[data-async]",function(g){var f=b(this);g.preventDefault();FormhybridAjaxRequest._asyncFormSubmit(f)})},_asyncFormSubmit:function(c,d,g){var e=c.serializeArray();e.push({name:"FORM_SUBMIT",value:c.attr("id")});if(typeof g!="undefined"){e.push(g)}function f(i,h){if(typeof i.result.data=="undefined"){return}if(!i.result.data.closeModal){return}h.closest(".modal").modal("hide")}b.ajax({url:d?d:c.attr("action"),dataType:"json",data:e,method:c.attr("method"),error:function(h,j,i){if(h.status==300){location.href=h.responseJSON.result.data.url;f(h.responseJSON,c);return}},success:function(j,l,k){if(typeof j=="undefined"){return}if(j.result.html&&j.result.data.id){var i="<div>"+j.result.html+"</div>",h=b(i).find("#"+j.result.data.id);if(typeof h!=="undefined"){c.replaceWith(h)}FormhybridPlugins.scrollToMessages(h);f(j,c)}}})},toggleSubpalette:function(e,d,g,c){e.blur();var k=b(e),j=k.attr("id"),i=b("#"+d),l=k.closest("form"),h=true,f=l.serializeArray();k.attr("disabled",true);f.push({name:"FORM_SUBMIT",value:l.attr("id")},{name:"subId",value:d},{name:"subField",value:g});if(k.is(":checkbox")||k.is(":radio")){h=k.is(":checked")}if(h===false){b.ajax({type:"post",url:c,dataType:"json",data:f,success:function(m){i.remove();k.closest("form").find("#"+j).attr("disabled",false)}});return}f.push({name:"subLoad",value:1});b.ajax({type:"post",url:c,dataType:"json",data:f,success:function(m,o,n){i.remove();if(k.closest("form").find("."+g).length>0){k.closest("form").find("."+g).eq(0).after(m.result.html)}else{k.closest("#ctrl_"+g).after(m.result.html)}k.closest("form").find("#"+j).attr("disabled",false)}})},reload:function(e,d){var c=b("#"+e);this._asyncFormSubmit(c,d)}};var a={getParameterByName:function(c,d){var g=decodeURIComponent(d),f=g.split("&"),h,e;for(e=0;e<f.length;e++){h=f[e].split("=");if(h[0]===c){return h[1]===undefined?true:h[1]}}}};b(document).ready(function(){FormhybridAjaxRequest.registerEvents();FormhybridPlugins.init()});b(document).ajaxComplete(function(e,d,c){if(typeof c=="undefined"){return false}FormhybridPlugins.init(a.getParameterByName("action",c.data))})})(jQuery);